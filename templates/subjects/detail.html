{% extends 'base.html' %} {% block content %}
<div class="d-flex flex-column gap-5">
  <div class="d-flex justify-content-between align-items-start">
    <div>
      <h2>{{ subject.title }}</h2>
      <p class="fs-5 text-muted">{{ subject.content }}</p>
    </div>
    <img
      class="img-fluid"
      src="/uploads/{{ subject.logo }}"
      alt="{{ subject.title }}"
    />
  </div>

  <div>
    <h3>교육목표</h3>
    <p class="fs-5 text-muted">{{ subject.objective }}</p>
  </div>

  <div>
    <h3>추천대상</h3>
    <p class="fs-5 text-muted">{{ subject.audience }}</p>
  </div>

  <div>
    <h3>수업 커리큘럼</h3>
    <table class="table">
      <thead class="table-light">
        <tr>
          <th scope="col">교시</th>
          <th scope="col">주제</th>
          <th scope="col">활동</th>
          <th scople="col">내용</th>
        </tr>
      </thead>
      <tbody>
        {% for item in curriculums %}
        <tr>
          <td>{{ item.period }}</td>
          <td>{{ item.topic }}</td>
          <td class="text-muted">{{ item.task }}</td>
          <td class="text-muted">{{ item.content }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div>
    <h3>
      <span class="d-flex justify-content-between align-items-center">
        활동사진
        <label for="upload" class="btn btn-secondary btn-sm">사진변경</label>
        <input type="file" class="d-none" id="upload" accept="image/*" />
      </span>
    </h3>
    <div class="w-100">
      <img
        src="/uploads/{{ subject.image}}"
        class="img-fluid mx-auto d-block"
        alt="활동 사진"
        style="height: auto"
      />
    </div>
  </div>

  <div class="d-flex justify-content-center">
    <a href="{% url 'subjects:apply' subject.id %}" class="btn btn-primary"
      >수업신청</a
    >
  </div>
</div>

<script>
  $("#upload").on("change", function () {
    // 이미지 파일 view에 전송
    const file = this.files[0];
    const formData = new FormData();
    formData.append("image", file);

    $.ajax({
      url: "/subjects/upload_image/{{ subject.id }}/",
      type: "POST",
      headers: { "X-CSRFToken": "{{ csrf_token }}" },
      data: formData,
      processData: false,
      contentType: false,
      success: function (response) {
        console.log("Image uploaded successfully");
      },
      error: function (error) {
        console.error("Error uploading image:", error);
      },
    });
  });
</script>
{% endblock %}
